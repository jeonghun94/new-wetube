(()=>{const e=document.getElementById("videoController"),t=document.getElementById("commentForm"),n=document.querySelectorAll(".video__comment span:last-child"),o=async e=>{const{target:{parentNode:t}}=e,n=t.dataset.id;200===(await fetch(`/api/comments/${n}`,{method:"DELETE"})).status&&t.remove()};n.forEach((e=>{e.addEventListener("click",o)})),t&&t.addEventListener("submit",(async n=>{n.preventDefault();const o=t.querySelector("textarea"),a=o.value,c=e.dataset.id;if(""===a)return;const d=await fetch(`/api/videos/${c}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a})});if(201===d.status){o.value="";const{newCommentId:e}=await d.json();((e,t)=>{const n=document.querySelector(".video__comments ul"),o=document.createElement("li");o.dataset.id=t,o.className="video__comment";const a=document.createElement("span");a.innerText=` ${e}`;const c=document.createElement("span");c.innerText="❌",o.appendChild(a),o.appendChild(c),n.prepend(o)})(a,e)}}))})();